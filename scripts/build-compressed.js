"use strict";function _objectWithoutProperties(a,b){if(null==a)return{};var c,d,e=_objectWithoutPropertiesLoose(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function _objectWithoutPropertiesLoose(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);return e}var _require=require("perf_hooks"),performance=_require.performance,fs=require("fs"),babel=require("@babel/core"),timer={time:function time(a){a=a||"Total Time",this[a]=this[a]?(performance.now()-this[a])/1e3:performance.now()},toString:function(){var a=this.toString,b=this.time,c=_objectWithoutProperties(this,["toString","time"]);return JSON.stringify(c,null,2)}};timer.time(),timer.time("Initialize");var args=process.argv.splice(3),projectLocation=__dirname+process.argv[2],config=JSON.parse(fs.readFileSync(projectLocation+"config.json"));if(["--watch","-w"].some(function(a){return args[0]==a}))console.error("Unsupported feature.");else{var taskName=args[0]||"build",task=config.tasks.find(function(a){return a.name==taskName}),files=[],findMatching=function(a){var b=a.split(/\/|\\/g),c=b.pop().split(/\*/g);c=c.map(function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")});var d=new RegExp(c.join("((?:\\s|\\S)+)")),e=b.join("/")+"/",f=fs.readdirSync(e).map(function(a){return e+a});return f.filter(function(a){return d.test(a)})};"string"==typeof task.includes?files=findMatching(task.includes):task.includes.forEach(function(a){return files.push(findMatching(a))}),files=Object.fromEntries(files.map(function(a){return[a,void 0]}));for(var file,_i=0,_Object$keys=Object.keys(files);_i<_Object$keys.length;_i++)file=_Object$keys[_i],files[file]=fs.readFileSync(projectLocation+file).toString();timer.time("Initialize"),console.log("Initialization completed in ".concat(timer.Initialize,"s.")),task.chain.forEach(function(a,b){timer.time("Chain ".concat(b));for(var c=0,d=Object.keys(files);c<d.length;c++){var e=d[c],f=a.destination,g=_objectWithoutProperties(a,["destination"]);g.filename=e,files[e]=babel.transformSync(files[e],g).code;var h=e.split(/\/|\\/g).pop(),i=h.split(".")[0];if(!files[e].match(/\s/g)){delete files[e];continue}f=f.replace(/%n/g,h).replace(/%o/g,i),fs.writeFileSync(projectLocation+f,files[e])}timer.time("Chain ".concat(b)),console.log("Chain ".concat(b," completed in ").concat(timer["Chain ".concat(b)],"s."))})}timer.time(),console.log(timer.toString());