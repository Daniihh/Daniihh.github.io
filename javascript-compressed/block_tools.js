"use strict";function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function _construct(){return _construct=isNativeReflectConstruct()?Reflect.construct:function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&_setPrototypeOf(f,d.prototype),f},_construct.apply(null,arguments)}function _defineProperty2(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray2(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray2(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _slicedToArray(a,b){return _arrayWithHoles2(a)||_iterableToArrayLimit(a,b)||_nonIterableRest2()}function _nonIterableRest2(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles2(a){if(Array.isArray(a))return a}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _decorate(a,b,c,d){var e=_getDecoratorsApi();if(d)for(var f=0;f<d.length;f++)e=d[f](e);var g=b(function(a){e.initializeInstanceElements(a,h.elements)},c),h=e.decorateClass(_coalesceClassElements(g.d.map(_createElementDescriptor)),a);return e.initializeClassElements(g.F,h.elements),e.runClassFinishers(g.F,h.finishers)}function _getDecoratorsApi(){_getDecoratorsApi=function(){return a};var a={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function initializeInstanceElements(a,b){["method","field"].forEach(function(c){b.forEach(function(b){b.kind===c&&"own"===b.placement&&this.defineClassElement(a,b)},this)},this)},initializeClassElements:function initializeClassElements(a,b){var c=a.prototype;["method","field"].forEach(function(d){b.forEach(function(b){var e=b.placement;if(b.kind===d&&("static"===e||"prototype"===e)){var f="static"===e?a:c;this.defineClassElement(f,b)}},this)},this)},defineClassElement:function defineClassElement(a,b){var c=b.descriptor;if("field"===b.kind){var d=b.initializer;c={enumerable:c.enumerable,writable:c.writable,configurable:c.configurable,value:void 0===d?void 0:d.call(a)}}Object.defineProperty(a,b.key,c)},decorateClass:function decorateClass(a,b){var c=[],d=[],e={static:[],prototype:[],own:[]};if(a.forEach(function(a){this.addElementPlacement(a,e)},this),a.forEach(function(a){if(!_hasDecorators(a))return c.push(a);var b=this.decorateElement(a,e);c.push(b.element),c.push.apply(c,b.extras),d.push.apply(d,b.finishers)},this),!b)return{elements:c,finishers:d};var f=this.decorateConstructor(c,b);return d.push.apply(d,f.finishers),f.finishers=d,f},addElementPlacement:function addElementPlacement(a,b,c){var d=b[a.placement];if(!c&&-1!==d.indexOf(a.key))throw new TypeError("Duplicated element ("+a.key+")");d.push(a.key)},decorateElement:function decorateElement(a,b){for(var c,d=[],e=[],f=a.decorators,g=f.length-1;0<=g;g--){c=b[a.placement],c.splice(c.indexOf(a.key),1);var h=this.fromElementDescriptor(a),k=this.toElementFinisherExtras((0,f[g])(h)||h);a=k.element,this.addElementPlacement(a,b),k.finisher&&e.push(k.finisher);var l=k.extras;if(l){for(var m=0;m<l.length;m++)this.addElementPlacement(l[m],b);d.push.apply(d,l)}}return{element:a,finishers:e,extras:d}},decorateConstructor:function decorateConstructor(a,b){for(var c=[],d=b.length-1;0<=d;d--){var e=this.fromClassDescriptor(a),f=this.toClassDescriptor((0,b[d])(e)||e);if(void 0!==f.finisher&&c.push(f.finisher),void 0!==f.elements){a=f.elements;for(var g=0;g<a.length-1;g++)for(var h=g+1;h<a.length;h++)if(a[g].key===a[h].key&&a[g].placement===a[h].placement)throw new TypeError("Duplicated element ("+a[g].key+")")}}return{elements:a,finishers:c}},fromElementDescriptor:function fromElementDescriptor(a){var b={kind:a.kind,key:a.key,placement:a.placement,descriptor:a.descriptor};return Object.defineProperty(b,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===a.kind&&(b.initializer=a.initializer),b},toElementDescriptors:function toElementDescriptors(a){return void 0===a?void 0:_toArray(a).map(function(a){var b=this.toElementDescriptor(a);return this.disallowProperty(a,"finisher","An element descriptor"),this.disallowProperty(a,"extras","An element descriptor"),b},this)},toElementDescriptor:function toElementDescriptor(a){var b=a.kind+"";if("method"!=b&&"field"!==b)throw new TypeError("An element descriptor's .kind property must be either \"method\" or \"field\", but a decorator created an element descriptor with .kind \""+b+"\"");var c=_toPropertyKey(a.key),d=a.placement+"";if("static"!==d&&"prototype"!==d&&"own"!==d)throw new TypeError("An element descriptor's .placement property must be one of \"static\", \"prototype\" or \"own\", but a decorator created an element descriptor with .placement \""+d+"\"");var e=a.descriptor;this.disallowProperty(a,"elements","An element descriptor");var f={kind:b,key:c,placement:d,descriptor:Object.assign({},e)};return"field"==b?(this.disallowProperty(e,"get","The property descriptor of a field descriptor"),this.disallowProperty(e,"set","The property descriptor of a field descriptor"),this.disallowProperty(e,"value","The property descriptor of a field descriptor"),f.initializer=a.initializer):this.disallowProperty(a,"initializer","A method descriptor"),f},toElementFinisherExtras:function toElementFinisherExtras(a){var b=this.toElementDescriptor(a),c=_optionalCallableProperty(a,"finisher"),d=this.toElementDescriptors(a.extras);return{element:b,finisher:c,extras:d}},fromClassDescriptor:function fromClassDescriptor(a){var b={kind:"class",elements:a.map(this.fromElementDescriptor,this)};return Object.defineProperty(b,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),b},toClassDescriptor:function toClassDescriptor(a){var b=a.kind+"";if("class"!=b)throw new TypeError("A class descriptor's .kind property must be \"class\", but a decorator created a class descriptor with .kind \""+b+"\"");this.disallowProperty(a,"key","A class descriptor"),this.disallowProperty(a,"placement","A class descriptor"),this.disallowProperty(a,"descriptor","A class descriptor"),this.disallowProperty(a,"initializer","A class descriptor"),this.disallowProperty(a,"extras","A class descriptor");var c=_optionalCallableProperty(a,"finisher"),d=this.toElementDescriptors(a.elements);return{elements:d,finisher:c}},runClassFinishers:function runClassFinishers(a,b){for(var c,d=0;d<b.length;d++)if(c=(0,b[d])(a),void 0!==c){if("function"!=typeof c)throw new TypeError("Finishers must return a constructor.");a=c}return a},disallowProperty:function disallowProperty(a,b,c){if(a[b]!==void 0)throw new TypeError(c+" can't have a ."+b+" property.")}};return a}function _createElementDescriptor(a){var b,c=_toPropertyKey(a.key);"method"===a.kind?b={value:a.value,writable:!0,configurable:!0,enumerable:!1}:"get"===a.kind?b={get:a.value,configurable:!0,enumerable:!1}:"set"===a.kind?b={set:a.value,configurable:!0,enumerable:!1}:"field"===a.kind&&(b={configurable:!0,writable:!0,enumerable:!0});var d={kind:"field"===a.kind?"field":"method",key:c,placement:a["static"]?"static":"field"===a.kind?"own":"prototype",descriptor:b};return a.decorators&&(d.decorators=a.decorators),"field"===a.kind&&(d.initializer=a.value),d}function _coalesceGetterSetter(a,b){a.descriptor.get===void 0?b.descriptor.set=a.descriptor.set:b.descriptor.get=a.descriptor.get}function _coalesceClassElements(a){for(var b=[],c=function(a){return"method"===a.kind&&a.key===f.key&&a.placement===f.placement},d=0;d<a.length;d++){var e,f=a[d];if(!("method"===f.kind&&(e=b.find(c))))b.push(f);else if(_isDataDescriptor(f.descriptor)||_isDataDescriptor(e.descriptor)){if(_hasDecorators(f)||_hasDecorators(e))throw new ReferenceError("Duplicated methods ("+f.key+") can't be decorated.");e.descriptor=f.descriptor}else{if(_hasDecorators(f)){if(_hasDecorators(e))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+f.key+").");e.decorators=f.decorators}_coalesceGetterSetter(f,e)}}return b}function _hasDecorators(a){return a.decorators&&a.decorators.length}function _isDataDescriptor(a){return a!==void 0&&(a.value!==void 0||a.writable!==void 0)}function _optionalCallableProperty(a,b){var c=a[b];if(c!==void 0&&"function"!=typeof c)throw new TypeError("Expected '"+b+"' to be a function");return c}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"===_typeof(b)?b:b+""}function _toPrimitive(a,b){if("object"!==_typeof(a)||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!==_typeof(d))return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}function _toArray(a){return _arrayWithHoles(a)||_iterableToArray(a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var BlockTools;(function(a){var b;(function(){})(b||(b=a.Map||(a.Map={})));var c=a.createXml=function(a){return Blockly.Xml.textToDom("<xml>"+a+"</xml>")},d=a.obtainXml=function(a){return Array.from(c(a).childNodes).crumble()},e=a.map=function(){var a=function(a,b,c){return{block:a,scope:b,diagram:c,getValue:function(b){return BlockTools.getValue(a,b)}}},b=function(a,b,c){return a[b]instanceof Array?a[b][a[b].push(c)-1]:(a[b]=c,a[b])},c=function(c,e,f,g,h,i){var j=i[c];if(j instanceof Object&&"function"!=typeof j)h=b(h,c,{}),d(e,f,g,h,j);else{if("function"==typeof j&&(j=j.call(a(f,h,g))),"string"!=typeof j)throw new TypeError("Invalid return value in \""+c+"\", expected string, got "+Object.getType(j)+".");b(h,c,BlockTools.getValue(f,j))}},d=function(b,e,f,g,h){if(!e.isInsertionMarker()){h=h||b.$main,f=f||{},g=g||f,g=h.$as?g=g[h.$as]=g[h.$as]||{}:g;var i=e.getNextBlock(),j=e.getPreviousBlock(),k=h.$next,l=h.$prev;h.$runme&&h.$runme.call(a(e,g,f));var m=function(d){var i=h[d];return["$next","$prev","$as","$runme"].includes(d)?"continue":["$lit_","$literal_"].some(function(a){return d.startsWith(a)})?(i=d.startsWith("$lit_")&&"function"==typeof i?i.call(a(e,g,f)):Object.clone(i),g[d.substr(d.indexOf("_")+1)]=i,"continue"):"string"==typeof i&&i.startsWith("$")?(g[d]=e.id,"continue"):void c(d,b,e,f,g,h)};for(var o in h){var n=m(o)}return k&&i&&("function"==typeof k&&(k=k.call(a(e,g,f),i)),d(b,i,f,g,b[k])),f}};return d}();(function(a){var b=function(a){function b(a,c,d){var e;if(_classCallCheck(this,b),a instanceof Error)e=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,"Encountered error while mapping.",a)),_defineProperty(_assertThisInitialized(e),"path",void 0),_defineProperty(_assertThisInitialized(e),"index",void 0),_defineProperty(_assertThisInitialized(e),"type",void 0);else{var f=d.split("."),g=f[c];f=f.slice(0,c);var h=function(a,b){return("string"==typeof a?a.length:a)+b.length+1},i=0==f.length?0:f.reduce(h);i="string"==typeof i?i.length+1:i,e=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,"No ".concat(a," with the name \"").concat(g,"\".\n\t\t").concat(d,"\n\t\t").concat(" ".repeat(i)).concat("~".repeat(g.length)))),_defineProperty(_assertThisInitialized(e),"path",void 0),_defineProperty(_assertThisInitialized(e),"index",void 0),_defineProperty(_assertThisInitialized(e),"type",void 0),e.path=d,e.index=c,e.type=a}return _possibleConstructorReturn(e)}return _inherits(b,a),b}(AdvancedError);a.MapperError=b})(b||(b=a.Map||(a.Map={})));var f=a.getValue=function(a,c){for(var d=function(a){return null=={false:!1,true:!0}[a.toLowerCase()]?isNaN(parseInt(a))?a:parseInt(a):{false:!1,true:!0}[a.toLowerCase()]},e=a,f=c.split("."),g=0;g<f.length;g++){e=e;var h=f[g];if(null==e.getInput(h)&&g!=f.length-1)throw new b.MapperError("input",g,c);else if(null==e.getField(h)&&g==f.length-1)throw new b.MapperError("field",g,c);if(e=g==f.length-1?e.getFieldValue(h):e.getInputTargetBlock(h),null==e)return}return d(e)},g=function(){function a(b,c){_classCallCheck(this,a),_defineProperty(this,"mapper",void 0),_defineProperty(this,"blockType",void 0),_defineProperty(this,"generators",{}),this.mapper=b,this.blockType=c}return _createClass(a,[{key:"generate",value:function generate(b,c){var d=this,e=b.getAllBlocks();if("string"==typeof this.blockType)e=e.filter(function(a){return a.type==d.blockType});else{var j=e;e=this.blockType(e),e=e.filter(function(a){return j.includes(a)})}var f={time:function time(a){this[a]=this[a]?(performance.now()-this[a])/1e3:performance.now()}};f.time("mapping");var g=e.map(function(b){return[b.id,function(){try{return BlockTools.map(d.mapper,b)}catch(b){return new a.GeneratorError("Map process failed.",b)}}()]});f.time("mapping");var h={};"string"==typeof c&&(c=this.generators[c]);var i=g.map(function(b){var d=_slicedToArray(b,2),e=d[0],g=d[1];if(g instanceof a.GeneratorError)return g;var i;f.time(e);try{i=c(g,h)}catch(b){i=new a.GeneratorError("Compile process failed.",b)}return i instanceof a.GeneratorError?f[e]=null:f.time(e),i});return console.debug("Generator Timing Object (In Seconds):",f),i}},{key:"addGenerator",value:function addGenerator(a,b){this.generators[b]=a}}]),a}();a.CodeGenerator=g,function(a){var b=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(AdvancedError);a.GeneratorError=b}(g||(g=a.CodeGenerator||(a.CodeGenerator={})));var h=function(){function a(){_classCallCheck(this,a),_defineProperty(this,"shown",""),_defineProperty(this,"used",""),_defineProperty(this,"problems",[])}return _createClass(a,[{key:"append",value:function append(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];for(var e,f=0,g=c;f<g.length;f++)if(e=g[f],e instanceof Array)e[0]&&(this.shown+=e[0]),e[1]&&(this.used+=e[1]);else if(e instanceof a){var h;this.shown+=e.getShown(),this.used+=e.getUsed(),(h=this.problems).push.apply(h,_toConsumableArray(e.getProblems()))}else this.shown+=e,this.used+=e;return this}},{key:"ifOver",value:function ifOver(b){var c=this.shown.length-this.shown.lastIndexOf("\n")>=b,d=this.used.length-this.used.lastIndexOf("\n")>=b;c&&(this.shown+="\n"),d&&(this.used+="\n");for(var e=arguments.length,f=Array(1<e?e-1:0),g=1;g<e;g++)f[g-1]=arguments[g];for(var h,i=0,j=f;i<j.length;i++)h=j[i],h instanceof Array?(c&&h[0]&&(this.shown+=h[0]),d&&h[1]&&(this.used+=h[1])):h instanceof a?(c&&(this.shown+=h.getShown()),d&&(this.used+=h.getUsed())):(c&&(this.shown+=h),d&&(this.used+=h));return this}},{key:"pushProblem",value:function pushProblem(a){return this.problems.push(a),this}},{key:"getShown",value:function getShown(){return this.shown}},{key:"getUsed",value:function getUsed(){return this.used}},{key:"getProblems",value:function getProblems(){return this.problems}}]),a}();a.Code=h;var i=_decorate(null,function(a){return{F:function b(){_classCallCheck(this,b),a(this)},d:[{kind:"field",key:"table",value:function value(){return{}}},{kind:"method",key:"divert",value:function(a){var b=this;return function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return d.unshift(this),a.apply(b,d)}}},{kind:"field",key:"updateDropdown",value:function value(){return this.divert(function(a){var b=Object.entries(this.table).map(function(b){return b.reverse()}),c=a&&"-1"!=a.getValue()?[["Delete Type...","-3"]]:[];return[["Anything","-1"]].concat(_toConsumableArray(b),[["Create Type...","-2"]],c)})}},{kind:"field",key:"validateDropdown",value:function value(){return this.divert(function(a,b){var c=this,d={"-2":function _(){return c.createType()||null},"-3":function _(){return c.deleteType(a.sourceBlock_.workspace,a.getValue())}},e=d[b]?d[b]():void 0;return e})}},{kind:"method",key:"getConstructArgs",value:function(){return[this.updateDropdown,this.validateDropdown]}},{kind:"method",decorators:[bound],key:"buildToolbox",value:function(){var a=function(a,b){return d("<button text=\""+a+"\" callbackKey=\""+b+"\"/>")},b="<block type=\"builder_type\"><field name=\"type\">",c="</field></block>",e=[a("Create Type...","createType")];for(var f in 0!=Object.keys(this.table).length&&e.push(a("Delete Type...","deleteType")),e.push(d([b,"-1",c].join(""))),this.table)e.push(d([b,f,c].join("")));return e}},{kind:"method",decorators:[bound],key:"createType",value:function(a){var b=prompt("Enter the name of the type to create...");if(![null,""].includes(b)){if(Object.values(this.table).includes(b))return alert("A type already exists with the name \""+b+"\".");var c=Math.max.apply(Math,[-1].concat(_toConsumableArray(Object.keys(this.table).map(function(a){return parseInt(a)}))))+1;return this.table[c]=b,a&&a.getTargetWorkspace().getToolbox().refreshSelection(),c.toString()}}},{kind:"method",decorators:[bound],key:"deleteType",value:function(a,b,c){if(a instanceof Blockly.Workspace){if(!Object.keys(this.table).includes(b))return!1;if(!c&&(c=confirm("Are you sure you want to delete the type \""+this.table[b]+"\"?"),!c))return!1;var d=Object.entries(this.table).find(function(a){var c=_slicedToArray(a,1),d=c[0];return d==b}),e=_slicedToArray(d,1),f=e[0];delete this.table[f];var g=!0,h=!1,i=void 0;try{for(var j,k,l=a.getAllBlocks()[Symbol.iterator]();!(g=(j=l.next()).done);g=!0)k=j.value,"builder_type"==k.type&&k.getField("type").getValue()==f&&k.dispose(!1,!0)}catch(a){h=!0,i=a}finally{try{g||null==l["return"]||l["return"]()}finally{if(h)throw i}}return!0}var m=this.table[Math.max.apply(Math,_toConsumableArray(Object.keys(this.table).map(function(b){return parseInt(b)})))];return(b=prompt("Enter the name of the type to delete...",m),![null,""].includes(b))&&((b=Object.fromEntries(Object.entries(this.table).map(function(b){return b.reverse()}))[b],this.deleteType(a.getTargetWorkspace(),b,!0))?(a.getTargetWorkspace().getToolbox().refreshSelection(),!0):(alert("No type exists with the name \""+b+"\"."),!1))}},{kind:"method",key:"register",value:function(a){a.registerToolboxCategoryCallback("TYPES",this.buildToolbox),a.registerButtonCallback("createType",this.createType),a.registerButtonCallback("deleteType",this.deleteType)}},{kind:"method",key:"toType",value:function(a){return"-1"==a?null:this.table[a]}}]}});a.Types=i;var j=function(){function a(b){_classCallCheck(this,a),_defineProperty(this,"name",void 0),_defineProperty(this,"colour",null),_defineProperty(this,"inputStyle",null),_defineProperty(this,"hat",void 0),_defineProperty(this,"inputs",[]),_defineProperty(this,"output",void 0),_defineProperty(this,"previous",void 0),_defineProperty(this,"next",void 0),this.name=b}return _createClass(a,[{key:"appendValueInput",value:function appendValueInput(b){return this.inputs.push(new a.ValueInput(b)),this}},{key:"appendStatementInput",value:function appendStatementInput(b){return this.inputs.push(new a.StatementInput(b)),this}},{key:"appendDummyInput",value:function appendDummyInput(){return this.inputs.push(new a.DummyInput),this}},{key:"getLastInput",value:function getLastInput(){return 0==this.inputs.length&&this.appendDummyInput(),this.inputs.last}},{key:"appendField",value:function appendField(a,b){return this.getLastInput().appendField(a,b),this}},{key:"setAlign",value:function setAlign(a){return this.getLastInput().setAlign(a),this}},{key:"setCheck",value:function setCheck(){var b=this.getLastInput();if(!(b instanceof a.TypedInput))throw new TypeError("The last input provided is not a TypedInput.");for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b.setCheck(d),this}},{key:"setOutput",value:function setOutput(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return"boolean"!=typeof b[0]||b.shift()?(this.output=b.crumbleFlat(),this):this}},{key:"setPreviousStatement",value:function setPreviousStatement(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return"boolean"!=typeof b[0]||b.shift()?(this.previous=b.crumbleFlat(),this):this}},{key:"setNextStatement",value:function setNextStatement(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return"boolean"!=typeof b[0]||b.shift()?(this.next=b.crumbleFlat(),this):this}},{key:"setBothStatements",value:function setBothStatements(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return"boolean"!=typeof b[0]||b.shift()?(this.next=b.crumbleFlat(),this.previous=this.next,this):this}},{key:"setHat",value:function setHat(a){return this.hat=a?"cap":void 0,this}},{key:"setInputsInline",value:function setInputsInline(a){return this.inputStyle=a,this}},{key:"setColour",value:function setColour(a){return this.colour=a,this}},{key:"build",value:function build(){var b=this,c=function(){var c=!0,d=!1,e=void 0;try{for(var f,g=b.inputs[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h,i=f.value,j=(h={},_defineProperty2(h,a.DummyInput.name,"DummyInput"),_defineProperty2(h,a.StatementInput.name,"StatementInput"),_defineProperty2(h,a.ValueInput.name,"ValueInput"),h)[i.constructor.name],k=i instanceof a.TypedInput?i:null,l=this["append"+j](k&&k.name);l.setAlign(i.alignment),k&&l.setCheck(k.acceptingType);var m=!0,n=!1,o=void 0;try{for(var p,q=i.fields[Symbol.iterator]();!(m=(p=q.next()).done);m=!0){var r,s=p.value;if("string"==typeof s){l.appendField(s);continue}var t=(r={},_defineProperty2(r,a.FieldAngle.name,"FieldAngle"),_defineProperty2(r,a.FieldDropdown.name,"FieldDropdown"),_defineProperty2(r,a.FieldTextInput.name,"FieldTextInput"),r)[s.constructor.name];l.appendField(_construct(Blockly[t],_toConsumableArray(s.getArguments())),s.name)}}catch(a){n=!0,o=a}finally{try{m||null==q["return"]||q["return"]()}finally{if(n)throw o}}}}catch(a){d=!0,e=a}finally{try{c||null==g["return"]||g["return"]()}finally{if(d)throw e}}this.setOutput(void 0!==b.output,b.output),this.setPreviousStatement(void 0!==b.previous,b.previous),this.setNextStatement(void 0!==b.next,b.next),this.setInputsInline(b.inputStyle),this.setColour(b.colour),this.hat=b.hat};return{init:c}}},{key:"register",value:function register(){Blockly.Blocks[this.name]=this.build()}}]),a}();a.Builder=j,function(a){var b=function(){function a(){_classCallCheck(this,a),_defineProperty(this,"fields",[]),_defineProperty(this,"alignment",-1)}return _createClass(a,[{key:"appendField",value:function appendField(a,b){return"string"==typeof a?this.fields.push(a):void(a.name=b,this.fields.push(a))}},{key:"setAlign",value:function setAlign(a){var b={LEFT:-1,CENTRE:0,RIGHT:1};this.alignment=null==b[a]?a:b[a]}}]),a}();a.Input=b;var c=function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this)),_defineProperty(_assertThisInitialized(c),"name",void 0),_defineProperty(_assertThisInitialized(c),"acceptingType",void 0),c.name=a,c}return _inherits(b,a),_createClass(b,[{key:"setCheck",value:function setCheck(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.acceptingType=b.crumbleFlat()}}]),b}(j.Input);a.TypedInput=c;var d=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(j.TypedInput);a.ValueInput=d;var e=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(j.TypedInput);a.StatementInput=e;var f=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(j.Input);a.DummyInput=f;var g=function(){function a(b,c){_classCallCheck(this,a),_defineProperty(this,"name",void 0),_defineProperty(this,"value",void 0),_defineProperty(this,"validator",void 0),this.value=b,this.validator=c}return _createClass(a,[{key:"getArguments",value:function getArguments(){return[this.value,this.validator]}}]),a}();a.Field=g;var h=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(j.Field);a.FieldAngle=h;var i=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),b}(j.Field);a.FieldTextInput=i;var k=function(a){function b(a,c){if(_classCallCheck(this,b),!(a instanceof Array)&&"function"!=typeof a)a=Object.entries(a).map(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return[d,c]});else if("function"==typeof a){var d=a;a=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var e=d.apply(this,b);return e instanceof Array?e:Object.entries(e).map(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return[d,c]})}}return _possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a,c))}return _inherits(b,a),_createClass(b,[{key:"getArguments",value:function getArguments(){return[this.value,this.validator]}}]),b}(j.Field);a.FieldDropdown=k}(j||(j=a.Builder||(a.Builder={})))})(BlockTools||(BlockTools={}));